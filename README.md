# duplicate-photos-and-files-cleaner
PowerShell scripts to find and delete duplicate photos, videos, and files from your devices - PCs, HDDs, SSDs, etc.

## Overview

This project contains four PowerShell scripts that work together to identify and remove duplicate files based on content hash (MD5 algorithm). The workflow consists of finder scripts that generate reports, followed by cleaner scripts that remove duplicates.

## Scripts

### 1. Duplicate-files-finder.ps1
Scans a directory for duplicate files of all types.

**What it does:**
- Recursively scans a folder for all files
- Computes MD5 hash for each file to identify duplicates
- Groups files by hash and identifies duplicates (same content)
- Marks the newest file to keep and older duplicates for deletion
- Exports results to a CSV file

**Usage:**
1. Edit the script and set the `$folder` variable to your target directory:
   ```powershell
   $folder = "D:\Your\Folder\Path"
   ```
2. Run the script:
   ```powershell
   .\Duplicate-files-finder.ps1
   ```
3. A CSV file will be created (default: `DuplicateFiles.csv`) with all findings

### 2. Duplicate-files-cleaner.ps1
Removes files marked for deletion from the CSV generated by the finder script.

**What it does:**
- Reads the CSV file from the finder script
- Displays all duplicates in preview mode first (safe)
- Optionally deletes files marked with "Delete" action

**Usage:**
1. Edit the script and set the `$csvPath` variable to your CSV file:
   ```powershell
   $csvPath = "D:\Your\Folder\Path\DuplicateFiles.csv"
   ```
2. Run the script to preview results:
   ```powershell
   .\Duplicate-files-cleaner.ps1
   ```
3. Review the preview output to verify which files will be deleted
4. To enable actual deletion, uncomment the delete section in the script
5. Run again to delete the marked files

### 3. Duplicate-photos-videos-finder.ps1
Scans a directory specifically for duplicate photos and videos.

**What it does:**
- Recursively scans a folder for media files only (jpg, jpeg, png, gif, bmp, mp4, avi, mov)
- Computes MD5 hash for each media file
- Groups files by hash to identify exact duplicates
- Marks the newest file to keep and older duplicates for deletion
- Exports results to a CSV file

**Usage:**
1. Edit the script and set the `$folder` variable to your target directory:
   ```powershell
   $folder = "C:\Your\Photos\Folder"
   ```
2. Run the script:
   ```powershell
   .\Duplicate-photos-videos-finder.ps1
   ```
3. A CSV file will be created (default: `Duplicate-Media-files.csv`) with all findings

### 4. Duplicate-photos-videos-cleaner.ps1
Removes media files marked for deletion from the CSV generated by the finder script.

**What it does:**
- Reads the CSV file from the media finder script
- Displays all duplicate media files in preview mode first (safe)
- Optionally deletes files marked with "Delete" action

**Usage:**
1. Edit the script and set the `$csvPath` variable to your CSV file:
   ```powershell
   $csvPath = "D:\Your\Folder\Path\Duplicate-Media-files.csv"
   ```
2. Run the script to preview results:
   ```powershell
   .\Duplicate-photos-videos-cleaner.ps1
   ```
3. Review the preview output carefully
4. To enable actual deletion, uncomment the delete section in the script
5. Run again to delete the marked files

## Workflow

### Finding and Cleaning All Duplicates:
1. Run `Duplicate-files-finder.ps1` to scan your entire folder
2. Review the generated CSV file
3. Run `Duplicate-files-cleaner.ps1` in preview mode first
4. Enable deletion and run `Duplicate-files-cleaner.ps1` again

### Finding and Cleaning Only Media Duplicates:
1. Run `Duplicate-photos-videos-finder.ps1` to scan for photos and videos
2. Review the generated CSV file
3. Run `Duplicate-photos-videos-cleaner.ps1` in preview mode first
4. Enable deletion and run `Duplicate-photos-videos-cleaner.ps1` again

## Important Notes

- **Preview First**: Always run the cleaner scripts in preview mode before enabling deletion
- **Keep Strategy**: The scripts keep the newest file and mark older duplicates for deletion (based on `LastWriteTime`)
- **CSV Review**: Review the CSV file before deletion to ensure you're deleting the right files
- **Backup**: Create backups of important files before running the cleaner scripts
- **Supported Media Formats**: jpg, jpeg, png, gif, bmp, mp4, avi, mov (can be customized in the script)
- **Requirements**: Run PowerShell with appropriate permissions to access files and delete them

## Safety Tips

1. Always test on a small folder first
2. Use preview mode to see what will be deleted
3. Review the CSV output before enabling deletion
4. Create a backup of your files before running deletion
5. Run the scripts one at a time, not in batch

## Author
**Shashidhar Addaguduru** - [GitHub](https://github.com/saddaguduru/) | [LinkedIn](https://www.linkedin.com/in/shashidhar-addaguduru/)